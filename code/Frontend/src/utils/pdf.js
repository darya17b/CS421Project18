import { jsPDF } from "jspdf";
import hpiDiagramDataUrl from "../assets/hpi-diagram.png?inline";

const get = (obj, path, fallback = "") => path.reduce((acc, k) => (acc ? acc[k] : undefined), obj) ?? fallback;
const pad = (s) => (s === 0 ? "0" : s ? String(s) : "");
const titleCase = (s = "") =>
  String(s)
    .replace(/_/g, " ")
    .replace(/\b\w/g, (m) => m.toUpperCase());
const getIcd10Code = (text = "") => {
  const match = String(text).toUpperCase().match(/\b[A-TV-Z][0-9][0-9AB](?:\.[0-9A-TV-Z]{1,4})?\b/);
  return match ? match[0] : "";
};

const COLORS = {
  crimson: "#a60e2c",
  crimsonDark: "#7b0a20",
  label: "#520716",
  dark: "#4d4d4d",
  body: "#000000",
  border: "#000000",
  soft: "#ffffff",
};
const INCH = 72;
const COVER_LOGO_DATA_URL = "data:image/png;base64,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";

const MARGIN = {
  left: 36,
  right: 18,
  top: 47,
  bottom: 52,
};
const VALUE_INDENT = 16.55;

function buildScriptPdfDoc(item, versionObj) {
  const doc = new jsPDF({ unit: "pt", format: "letter" });
  const pageWidth = doc.internal.pageSize.getWidth();
  const pageHeight = doc.internal.pageSize.getHeight();
  const contentWidth = pageWidth - MARGIN.left - MARGIN.right;
  const bodyTop = MARGIN.top + 8;
  const bodyBottom = pageHeight - MARGIN.bottom;
  let defaultFieldValueSize = 11;
  let y = bodyTop;

  const version = versionObj || (item.versions && item.versions[0]) || { version: "v1", fields: {}, notes: "" };
  const fields = version.fields || {};

  const patientName = get(fields, ["patient", "name"], item.title || "Standardized Patient");
  const diagnosis = get(fields, ["admin", "diagnosis"], "Diagnosis TBD");

  const setText = (size = 11, weight = "normal", color = COLORS.body, family = "helvetica") => {
    doc.setFont(family, weight);
    doc.setFontSize(size);
    doc.setTextColor(color);
  };

  const addPageChrome = () => {};

  const newBodyPage = () => {
    doc.addPage();
    addPageChrome();
    y = bodyTop;
  };

  const ensureSpace = (space = 18) => {
    if (y + space > bodyBottom) {
      newBodyPage();
    }
  };

  const drawPartHeading = (title) => {
    ensureSpace(32);
    setText(16, "bold", COLORS.crimson);
    doc.text(title, pageWidth / 2, y, { align: "center" });
    y += 21;
  };

  const drawSectionHeading = (title) => {
    ensureSpace(22);
    setText(12, "bold", COLORS.body);
    doc.text(title, MARGIN.left, y);
    y += 16;
  };

  const drawField = (label, value, options = {}) => {
    const {
      emptyText = "None",
      labelIndent = 0,
      valueIndent = VALUE_INDENT,
      labelColor = COLORS.body,
      labelWeight = "bold",
      labelSize = 12,
      valueColor = COLORS.body,
      valueWeight = "normal",
      valueSize = defaultFieldValueSize,
      valueBottomGap = 6,
    } = options;
    const labelX = MARGIN.left + labelIndent;
    const valueX = MARGIN.left + valueIndent;
    const requestedRightInset = Number(options.valueRightInset);
    const valueRightInset = Number.isFinite(requestedRightInset) && requestedRightInset >= 0
      ? requestedRightInset
      : MARGIN.right;
    const baseWrapWidth = Math.max(40, pageWidth - valueX - valueRightInset);
    const requestedWrapWidth = Number(options.valueWrapWidth);
    const valueWrapWidth = Number.isFinite(requestedWrapWidth) && requestedWrapWidth > 0
      ? Math.min(requestedWrapWidth, baseWrapWidth)
      : baseWrapWidth;
    const clean = value === undefined || value === null ? "" : String(value).trim();
    setText(valueSize, valueWeight, valueColor);
    const wrapped = clean ? doc.splitTextToSize(clean, valueWrapWidth) : [emptyText];
    const labelHeight = 13;
    const valueHeight = Math.max(13, wrapped.length * 13);
    ensureSpace(labelHeight + valueHeight + 6);

    setText(labelSize, labelWeight, labelColor);
    doc.text(`${label}:`, labelX, y);
    setText(valueSize, valueWeight, valueColor);
    y += labelHeight;
    doc.text(wrapped, valueX, y);
    y += valueHeight + valueBottomGap;
  };

  const drawParagraph = (label, value) => {
    drawField(label, value);
  };

  const drawObject = (obj) => {
    Object.entries(obj || {}).forEach(([key, value]) => {
      drawField(titleCase(key), value);
    });
  };

  const normalizeTextEntries = (value) => {
    if (Array.isArray(value)) {
      return value
        .map((entry) => {
          if (typeof entry === "string") return entry;
          if (entry && typeof entry === "object") {
            if (entry.text) return entry.text;
            if (entry.name) return entry.name;
          }
          return "";
        })
        .map((entry) => String(entry || "").trim())
        .filter(Boolean);
    }
    if (value && typeof value === "object") {
      return [];
    }
    return String(value || "")
      .split(/\r?\n/)
      .map((line) => line.replace(/^\s*(?:[-*•]|â€¢)\s*/, "").trim())
      .filter(Boolean);
  };

  const drawListField = (label, entries, options = {}) => {
    const {
      emptyText = "None",
      bulletPrefix = "-",
      labelIndent = 0,
      valueIndent = VALUE_INDENT,
      labelColor = COLORS.body,
      labelWeight = "bold",
      labelSize = 12,
      valueColor = COLORS.body,
      valueWeight = "normal",
      valueSize = 11,
    } = options;
    const cleanEntries = (entries || [])
      .map((entry) => String(entry || "").trim())
      .filter(Boolean);
    const labelX = MARGIN.left + labelIndent;
    const valueX = MARGIN.left + valueIndent;
    const valueWrapWidth = Math.max(40, pageWidth - valueX - MARGIN.right);
    setText(valueSize, valueWeight, valueColor);
    const outputLines = cleanEntries.length
      ? cleanEntries.flatMap((entry) => {
          const prefix = String(bulletPrefix || "").trim();
          const lineText = prefix ? `${prefix} ${entry}` : entry;
          return doc.splitTextToSize(lineText, valueWrapWidth);
        })
      : [emptyText];
    const labelHeight = 13;
    const valueHeight = Math.max(13, outputLines.length * 13);
    ensureSpace(labelHeight + valueHeight + 6);

    setText(labelSize, labelWeight, labelColor);
    doc.text(`${label}:`, labelX, y);
    setText(valueSize, valueWeight, valueColor);
    y += labelHeight;
    doc.text(outputLines, valueX, y);
    y += valueHeight + 6;
  };

  const drawGroupedListField = (label, groups, options = {}) => {
    const {
      emptyText = "None",
      labelIndent = 0,
      primaryIndent = VALUE_INDENT * 2,
      additionalIndent = VALUE_INDENT * 3,
      labelColor = COLORS.body,
      labelWeight = "bold",
      labelSize = 12,
      valueColor = COLORS.body,
      valueWeight = "normal",
      valueSize = 11,
    } = options;

    const labelX = MARGIN.left + labelIndent;
    const normalizedGroups = (Array.isArray(groups) ? groups : [])
      .map((group) => {
        if (!group || typeof group !== "object") return null;
        const primary = String(group.primary || "").trim();
        const additional = (Array.isArray(group.additional) ? group.additional : [])
          .map((line) => String(line || "").trim())
          .filter(Boolean);
        return primary || additional.length ? { primary, additional } : null;
      })
      .filter(Boolean);

    const renderedLines = [];
    if (!normalizedGroups.length) {
      renderedLines.push({ text: emptyText, indent: primaryIndent });
    } else {
      normalizedGroups.forEach((group) => {
        if (group.primary) renderedLines.push({ text: group.primary, indent: primaryIndent });
        group.additional.forEach((line) => renderedLines.push({ text: line, indent: additionalIndent }));
      });
    }

    const wrappedLines = renderedLines.flatMap((line) => {
      const x = MARGIN.left + line.indent;
      const wrapWidth = Math.max(40, pageWidth - x - MARGIN.right);
      const chunks = doc.splitTextToSize(line.text, wrapWidth);
      return chunks.map((chunk) => ({ text: chunk, x }));
    });

    const labelHeight = 13;
    const lineHeight = 13;
    const valueHeight = Math.max(13, wrappedLines.length * lineHeight);
    ensureSpace(labelHeight + valueHeight + 6);

    setText(labelSize, labelWeight, labelColor);
    doc.text(`${label}:`, labelX, y);
    setText(valueSize, valueWeight, valueColor);
    y += labelHeight;
    wrappedLines.forEach((line, idx) => {
      doc.text(line.text, line.x, y + idx * lineHeight);
    });
    y += valueHeight + 6;
  };

  const formatMedicationEntry = (entry) => {
    if (typeof entry === "string") return entry.trim();
    if (!entry || typeof entry !== "object") return "";
    if (entry.text) return String(entry.text).trim();
    const lead = [pad(entry.name), pad(entry.dose)].filter(Boolean).join(" ");
    const trail = [pad(entry.frequency), pad(entry.reason), pad(entry.otherNotes)].filter(Boolean).join(" - ");
    const merged = [lead, trail].filter(Boolean).join(" - ");
    return merged.trim();
  };

  const formatFamilyHistoryEntry = (entry) => {
    if (typeof entry === "string") return entry.trim();
    if (!entry || typeof entry !== "object") return "";
    const familyMember = pad(entry.family_member);
    const details = pad(entry.details);
    if (familyMember || details) {
      return [familyMember || "Family member", details].filter(Boolean).join(" - ").trim();
    }
    const relation = pad(entry.relation);
    const status = pad(entry.status);
    const conditions = pad(entry.conditions) || pad(entry.health_status);
    const notes = pad(entry.notes) || pad(entry.additonal_info);
    const cause = pad(entry.cause_of_death);
    const statusLower = String(status || "").toLowerCase();

    let line = [relation || "Family member"];
    if (conditions) line.push(conditions);
    let text = line.join(" - ");
    if (status) text += ` (${status})`;
    if (statusLower === "deceased" && cause) text += `; Cause of death: ${cause}`;
    if (notes) text += `; ${notes}`;
    return text.trim();
  };

  const formatTemperaturePair = (reading, unitRaw) => {
    const n = Number(reading);
    if (!Number.isFinite(n) || n <= 0) return "";
    const unit = Number(unitRaw);
    const c = unit === 1 ? (n - 32) * (5 / 9) : n;
    const f = unit === 1 ? n : (n * (9 / 5) + 32);
    const toOne = (value) => Number(value.toFixed(1)).toString();
    return `${toOne(c)} C / ${toOne(f)} F`;
  };

  const drawCharacterAttributesTable = () => {
    const attrs = [
      ["Anxiety", "anxiety"],
      ["Surprise", "suprise"],
      ["Confusion", "confusion"],
      ["Guilt", "guilt"],
      ["Sadness", "sadness"],
      ["Indecision", "indecision"],
      ["Assertiveness", "assertiveness"],
      ["Frustration", "frustration"],
      ["Fear", "fear"],
      ["Anger", "anger"],
    ];
    const levels = ["None", "Mild", "Moderate", "Concerning", "Severe"];
    const rowH = 20;
    const headerH = rowH;
    const tableLeft = MARGIN.left;
    const tableWidth = pageWidth - MARGIN.left * 2;
    const labelW = 146;
    const levelW = (tableWidth - labelW) / 5;
    const tableH = headerH + attrs.length * rowH;
    ensureSpace(tableH + 8);

    doc.setDrawColor(COLORS.border);
    doc.setLineWidth(0.75);

    setText(10, "bold", COLORS.body);
    doc.rect(tableLeft, y, labelW, headerH);
    // Top-left header cell intentionally left blank.

    for (let i = 0; i < 5; i++) {
      const x = tableLeft + labelW + i * levelW;
      doc.rect(x, y, levelW, headerH);
      const lines = doc.splitTextToSize(`${i + 1} ${levels[i]}`, levelW);
      doc.text(lines, x + levelW, y + 12, { align: "right" });
    }
    y += headerH;

    attrs.forEach(([label, key]) => {
      const raw = Number(get(fields, ["sp", "attributes", key], 1));
      const selected = Math.max(1, Math.min(5, Number.isFinite(raw) ? raw : 1));

      setText(10, "normal", COLORS.body);
      doc.rect(tableLeft, y, labelW, rowH);
      doc.text(label, tableLeft + labelW, y + 13, { align: "right" });

      for (let i = 1; i <= 5; i++) {
        const x = tableLeft + labelW + (i - 1) * levelW;
        doc.setFillColor(i === selected ? 249 : 255, i === selected ? 200 : 255, i === selected ? 210 : 255);
        doc.rect(x, y, levelW, rowH, "FD");
        setText(10, "normal", COLORS.body);
        doc.text(String(i), x + levelW, y + 13, { align: "right" });
      }

      y += rowH;
    });

    y += 6;
  };

  const drawSeverity = () => {
    const rawSeverity = Number(get(fields, ["sp", "current_ill_history", "pain"], 0));
    const severity = Number.isFinite(rawSeverity)
      ? Math.max(0, Math.min(10, Math.round(rawSeverity)))
      : 0;
    const chiefConcern = String(
      get(fields, ["admin", "chief_concern"], get(fields, ["patient", "visit_reason"], ""))
    ).trim() || "None";
    const tableTopPadding = 16;
    const scoreRowH = 16;
    const concernRowH = 22;
    ensureSpace(16 + tableTopPadding + scoreRowH + concernRowH + 8);
    const boxW = contentWidth / 11;
    const severityLabel = "Severity/Quality of Symptom(s):";
    const labelX = MARGIN.left + VALUE_INDENT;

    setText(12, "normal", COLORS.crimsonDark);
    doc.text(severityLabel, labelX, y + 12);
    y += 16;
    y += tableTopPadding;

    for (let i = 0; i <= 10; i++) {
      const x = MARGIN.left + i * boxW;
      const selected = i === severity;
      doc.setFillColor(i === severity ? 249 : 255, i === severity ? 200 : 255, i === severity ? 210 : 255);
      doc.setDrawColor(COLORS.border);
      doc.rect(x, y, boxW, scoreRowH, "FD");
      setText(12, "normal", COLORS.body);
      doc.text(String(i), x + boxW / 2, y + 12, { align: "center" });
    }
    y += scoreRowH;

    for (let i = 0; i <= 10; i++) {
      const x = MARGIN.left + i * boxW;
      const selected = i === severity;
      doc.setFillColor(selected ? 249 : 255, selected ? 200 : 255, selected ? 210 : 255);
      doc.setDrawColor(COLORS.border);
      doc.rect(x, y, boxW, concernRowH, "FD");
      if (selected) {
        const lines = doc.splitTextToSize(chiefConcern, boxW - 2).slice(0, 2);
        setText(12, "normal", COLORS.body);
        doc.text(lines, x + 1, y + 11, { align: "left" });
      }
    }
    y += concernRowH + 8;
  };

  const drawHpiDiagram = (options = {}) => {
    if (!hpiDiagramDataUrl) return;
    const {
      label = "Symptom Location Diagram",
      labelColor = COLORS.body,
      labelWeight = "bold",
      labelSize = 12,
      labelIndent = 0,
      centered = false,
      maxWidth = 240,
    } = options;
    const labelHeight = 14;
    const renderWidth = Math.min(contentWidth, Number(maxWidth) > 0 ? Number(maxWidth) : 240);
    const rawMarkers = get(fields, ["sp", "current_ill_history", "symptom_diagram"], []);
    const markers = (Array.isArray(rawMarkers) ? rawMarkers : [rawMarkers])
      .map((m) => ({ x: Number(m?.x), y: Number(m?.y) }))
      .filter((m) => Number.isFinite(m.x) && Number.isFinite(m.y));
    const drawHeartMarker = (cx, cy, size = 12) => {
      const radius = size * 0.28;
      const lobeY = cy - size * 0.18;
      doc.setFillColor(176, 12, 38);
      doc.setDrawColor(255, 255, 255);
      doc.setLineWidth(0.8);
      doc.circle(cx - radius, lobeY, radius, "FD");
      doc.circle(cx + radius, lobeY, radius, "FD");
      doc.triangle(
        cx - radius * 2,
        lobeY,
        cx + radius * 2,
        lobeY,
        cx,
        cy + size * 0.75,
        "FD"
      );
    };

    ensureSpace(labelHeight + 20);
    setText(labelSize, labelWeight, labelColor);
    const labelX = MARGIN.left + (Number.isFinite(Number(labelIndent)) ? Number(labelIndent) : 0);
    doc.text(`${label}:`, labelX, y);
    y += labelHeight;

    try {
      const props = doc.getImageProperties(hpiDiagramDataUrl);
      const ratio = props?.width && props?.height ? props.height / props.width : 1;
      const width = renderWidth;
      const height = Math.max(40, width * ratio);
      ensureSpace(height + 8);
      const imageX = centered ? MARGIN.left + (contentWidth - width) / 2 : MARGIN.left;
      doc.addImage(hpiDiagramDataUrl, "PNG", imageX, y, width, height);
      markers.forEach((marker) => {
        const x = imageX + Math.max(0, Math.min(1, marker.x)) * width;
        const heartY = y + Math.max(0, Math.min(1, marker.y)) * height;
        drawHeartMarker(x, heartY, 12);
      });
      y += height + 8;
      setText(10, "normal", COLORS.dark);
      doc.text(`Symptom markers: ${markers.length}`, imageX, y);
      y += 12;
    } catch {
      drawField(label, "Unable to render diagram.", {
        labelColor,
        labelWeight,
        labelSize,
      });
    }
  };

  const drawItemsToIncludeTable = () => {
    const labelHeight = 14;
    const topRowHeight = 19;
    const rowHeight = 19;
    const tableWidth = contentWidth;
    const colWidth = tableWidth / 3;
    const rows = [
      ["Door Note", "History", "Medications/Allergies"],
      ["ROS", "Labs", "EKG"],
      ["Family History", "Orders", "Radiology"],
      ["Note", "Other", "Other"],
    ];
    const tableHeight = topRowHeight + rows.length * rowHeight;

    ensureSpace(labelHeight + tableHeight + 8);

    setText(12, "bold", COLORS.body);
    doc.text("Items to include:", MARGIN.left, y);
    y += labelHeight;

    doc.setDrawColor(COLORS.border);
    doc.setLineWidth(0.75);

    // Top row spans all columns.
    doc.rect(MARGIN.left, y, tableWidth, topRowHeight);
    setText(11, "normal", COLORS.body);
    doc.text("None \\ Not Used", MARGIN.left + tableWidth / 2, y + 13, { align: "center" });
    y += topRowHeight;

    rows.forEach((row) => {
      for (let c = 0; c < 3; c++) {
        const cellX = MARGIN.left + c * colWidth;
        doc.rect(cellX, y, colWidth, rowHeight);
        const text = doc.splitTextToSize(row[c], colWidth - 8);
        doc.text(text, cellX + colWidth / 2, y + 13, { align: "center" });
      }
      y += rowHeight;
    });

    y += 8;
  };

  const drawReportReleaseTimingTable = () => {
    const topPadding = 16;
    const horizontalInset = 18;
    const labelHeight = 14;
    const rowHeight = 19;
    const tableX = MARGIN.left + horizontalInset;
    const tableWidth = contentWidth - horizontalInset * 2;
    const colWidth = tableWidth / 4;
    const cols = ["Before", "During", "After with video", "After without video"];
    const tableHeight = rowHeight;

    ensureSpace(topPadding + labelHeight + tableHeight + 8);
    y += topPadding;

    setText(12, "bold", COLORS.body);
    doc.text("Report Release Timing:", MARGIN.left, y);
    y += labelHeight;

    doc.setDrawColor(COLORS.border);
    doc.setLineWidth(0.75);
    setText(11, "normal", COLORS.body);

    cols.forEach((col, idx) => {
      const cellX = tableX + idx * colWidth;
      doc.rect(cellX, y, colWidth, rowHeight);
      const text = doc.splitTextToSize(col, colWidth - 8);
      doc.text(text, cellX + colWidth / 2, y + 13, { align: "center" });
    });
    y += rowHeight;

    y += 8;
  };

  const drawCoverPage = () => {
    const textBlockWidth = pageWidth - MARGIN.left - MARGIN.right;
    const logoX = MARGIN.left;
    const logoY = 0.95 * INCH;
    const logoW = pageWidth - MARGIN.left - 10;
    const logoH = (536 / 1503) * logoW;
    const titleY = logoY + logoH + 34;
    const icd10Code = getIcd10Code(diagnosis);
    const normalizeWhitespace = (text = "") => String(text).trim().replace(/\s+/g, " ");
    const demographicLabel = normalizeWhitespace(get(fields, ["admin", "patient_demographic"], "")) || "Unknown";
    const formatCoverPatientName = (name = "") => {
      const clean = normalizeWhitespace(name);
      if (!clean) return "UNKNOWN PATIENT";
      if (clean.includes(",")) return clean.toUpperCase();
      const parts = clean.split(" ");
      if (parts.length < 2) return clean.toUpperCase();
      const first = parts[0];
      const last = parts[parts.length - 1];
      return `${last}, ${first}`.toUpperCase();
    };
    const diagnosisNoCode = normalizeWhitespace(
      String(diagnosis || "").replace(/\b[A-TV-Z][0-9][0-9AB](?:\.[0-9A-TV-Z]{1,4})?\b/i, "")
    );
    const coverDiagnosisLine = (() => {
      if (icd10Code && diagnosisNoCode) return `${icd10Code} ${diagnosisNoCode}`.toUpperCase();
      if (icd10Code) return icd10Code.toUpperCase();
      const fallback = normalizeWhitespace(diagnosis) || "Diagnosis TBD";
      return fallback.toUpperCase();
    })();

    try {
      doc.addImage(COVER_LOGO_DATA_URL, "PNG", logoX, logoY, logoW, logoH);
    } catch {
      doc.setFillColor(COLORS.crimson);
      doc.rect(logoX, logoY, 54, 54, "F");
      setText(14, "bold", "#ffffff", "helvetica");
      doc.text("WSU", logoX + 27, logoY + 34, { align: "center" });
    }

    setText(40, "normal", "#961e30");
    doc.text("Virtual Clinical Center", MARGIN.left, titleY, { maxWidth: textBlockWidth });

    setText(11, "normal", COLORS.dark);
    const coverPatientLine = `${demographicLabel.toUpperCase()} STANDARDIZED PATIENT: ${formatCoverPatientName(patientName)} - ${coverDiagnosisLine}`;
    doc.text(coverPatientLine, MARGIN.left, titleY + 23, { maxWidth: textBlockWidth });

  };

  const startPart = (title, partPages) => {
    doc.addPage();
    partPages.push({ title, page: doc.getNumberOfPages() });
    addPageChrome();
    y = bodyTop;
    drawPartHeading(title);
  };

  const writeContentsPage = (partPages) => {
    doc.setPage(2);
    const centerX = pageWidth / 2;
    let tocY = MARGIN.top + 20;

    setText(16, "bold", COLORS.crimsonDark);
    doc.text("Contents", centerX, tocY, { align: "center" });
    tocY += 24;

    setText(11, "bold", COLORS.body);
    partPages.forEach(({ title, page }) => {
      const left = MARGIN.left;
      const right = pageWidth - MARGIN.right;
      const pageText = String(page);
      const pageW = doc.getTextWidth(pageText);
      const leaderWidth = right - left - pageW - 8;
      const labelMax = Math.max(80, leaderWidth - 18);
      const clipped = doc.splitTextToSize(title, labelMax)[0] || title;
      const clippedW = doc.getTextWidth(clipped);
      const dotW = doc.getTextWidth(".");
      const dotCount = Math.max(3, Math.floor((leaderWidth - clippedW) / dotW));
      doc.text(`${clipped}${".".repeat(dotCount)}`, left, tocY);
      doc.text(pageText, right, tocY, { align: "right" });
      tocY += 18;
    });
  };

  const addPageNumbers = () => {
    const totalPages = doc.getNumberOfPages();
    for (let p = 3; p <= totalPages; p++) {
      doc.setPage(p);
      setText(10, "normal", COLORS.dark);
      doc.text(String(p), pageWidth - MARGIN.right, pageHeight - 18, { align: "right" });
    }
  };

  const partPages = [];

  // Cover and reserved contents page
  drawCoverPage();
  doc.addPage();

  // Part 1
  defaultFieldValueSize = 12;
  startPart("Part 1 - Administrative Details", partPages);
  drawField("Patient's Reason for Visit", get(fields, ["admin", "reson_for_visit"], ""));
  drawField("Chief Complaint", get(fields, ["admin", "chief_concern"], ""));
  drawField("ICD-10 and Diagnosis", get(fields, ["admin", "diagnosis"], ""));
  drawField("Case Letter", get(fields, ["admin", "case_letter"], get(fields, ["admin", "class"], "")));
  drawField("Event Format", get(fields, ["admin", "medical_event"], get(fields, ["admin", "event_dates"], "")));
  drawField("Learner Level", get(fields, ["admin", "learner_level"], ""));
  drawField("Level of the learner and discipline", get(fields, ["admin", "academic_year"], ""));
  drawField("Case Authors", get(fields, ["admin", "case_authors"], get(fields, ["admin", "author"], "")));
  drawParagraph("Summary of Patient Story", get(fields, ["admin", "summory_of_story"], ""));
  drawListField("Student Expectations", normalizeTextEntries(get(fields, ["admin", "student_expectations"], "")), {
    bulletPrefix: "-",
  });
  drawField("Demographics of patient/recruitment guidelines", get(fields, ["admin", "patient_demographic"], ""), { emptyText: "Unknown" });
  drawField("List of special supplies needed for encounter", get(fields, ["admin", "special_supplies"], ""));
  drawField("Case factors associated with social determinants of health", get(fields, ["admin", "case_factors"], ""));
  drawField("Additional Instructions", get(fields, ["special", "feed_back"], ""));
  // Part 2
  startPart("Part 2 - Door Chart/Note and Learner Instruction", partPages);
  drawSectionHeading("Instructions to Learners:");
  const learnerLabelStyle = { labelColor: COLORS.crimsonDark, labelWeight: "normal" };
  drawField("Patient Name", patientName, learnerLabelStyle);
  drawField("Date of Birth", get(fields, ["patient", "date_of_birth"], get(fields, ["patient", "dob"], "")), {
    ...learnerLabelStyle,
    emptyText: "Not provided",
  });
  const hr = Number(get(fields, ["patient", "vitals", "heart_rate"], 0));
  const rr = Number(get(fields, ["patient", "vitals", "respirations"], 0));
  const bpTop = Number(get(fields, ["patient", "vitals", "pressure", "top"], 0));
  const bpBottom = Number(get(fields, ["patient", "vitals", "pressure", "bottom"], 0));
  const spo2 = Number(get(fields, ["patient", "vitals", "blood_oxygen"], 0));
  const tempReading = get(fields, ["patient", "vitals", "temp", "reading"], "");
  const tempUnit = get(fields, ["patient", "vitals", "temp", "unit"], "");

  const vitalLines = [
    hr > 0 ? `${hr} Beats/min` : "",
    rr > 0 ? `${rr} Respirations/min` : "",
    bpTop > 0 && bpBottom > 0 ? `${bpTop}/${bpBottom} mmHg` : "",
    spo2 > 0 ? `${spo2} %` : "",
    formatTemperaturePair(tempReading, tempUnit),
  ].filter(Boolean);
  drawListField("Vital Signs", vitalLines, {
    ...learnerLabelStyle,
    emptyText: "Not provided",
    bulletPrefix: "-",
  });
  drawField("Reason For Visit", get(fields, ["patient", "visit_reason"], get(fields, ["admin", "reson_for_visit"], "")), learnerLabelStyle);
  drawField("Context", get(fields, ["patient", "context"], ""), learnerLabelStyle);
  drawField("Task", get(fields, ["patient", "task"], ""), learnerLabelStyle);
  drawField("Patient Encounter Duration", get(fields, ["patient", "encounter_duration"], ""), learnerLabelStyle);

  // Part 3
  startPart("Part 3 - Reports to Release", partPages);
  drawItemsToIncludeTable();
  drawReportReleaseTimingTable();

  // Part 4
  startPart("Part 4 - Content for standardized patients", partPages);
  const openingStatement = String(get(fields, ["sp", "opening_statement"], ""))
    .replace(/\s*\r?\n\s*/g, " ")
    .trim();
  drawField("Opening Statement", openingStatement);
  drawSectionHeading("Character Attributes:");
  drawCharacterAttributesTable();
  ensureSpace(20);
  y += 20;
  const nonverbalBehavior = String(get(fields, ["sp", "physical_chars"], ""))
    .replace(/\s*\r?\n\s*/g, " ")
    .trim();
  drawField("Nonverbal behavior and physical characteristics", nonverbalBehavior);
  newBodyPage();

  drawField("Chief Complaint", get(fields, ["admin", "chief_concern"], get(fields, ["patient", "visit_reason"], "")), {
    valueIndent: VALUE_INDENT * 2,
  });
  drawSectionHeading("History of Present Illness (HPI):");
  drawHpiDiagram({
    label: "Place/Location of Symptoms",
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelIndent: VALUE_INDENT,
    centered: true,
    maxWidth: 300,
  });
  ensureSpace(16);
  y += 16;
  const hpiDetailLabelStyle = {
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    valueSize: 12,
    valueBottomGap: 0,
  };
  drawField("Setting in which Symptom(s) Occur", get(fields, ["sp", "current_ill_history", "symptom_settings"], ""), hpiDetailLabelStyle);
  drawField("Timing of Symptom(s)", get(fields, ["sp", "current_ill_history", "symptom_timing"], ""), hpiDetailLabelStyle);
  drawField("Associated Symptoms", get(fields, ["sp", "current_ill_history", "associated_symptoms"], ""), hpiDetailLabelStyle);
  drawField(
    "Quality of Symptom(s)",
    get(fields, ["sp", "current_ill_history", "symptom_quality"], ""),
    hpiDetailLabelStyle
  );
  drawField(
    "Radiation of Symptom(s)",
    get(fields, ["sp", "current_ill_history", "radiation_of_symptoms"], ""),
    hpiDetailLabelStyle
  );
  drawField("Alleviating Factors of Symptom(s)", get(fields, ["sp", "current_ill_history", "alleviating_factors"], ""), hpiDetailLabelStyle);
  drawField("Aggravating Factors of Symptom(s)", get(fields, ["sp", "current_ill_history", "aggravating_factors"], ""), hpiDetailLabelStyle);
  drawSeverity();
  newBodyPage();

  drawSectionHeading("Medications and Allergies");
  const rxMedsRaw = get(fields, ["med_hist", "medications"], []);
  const rxMedEntries = (Array.isArray(rxMedsRaw) ? rxMedsRaw : [rxMedsRaw]).map(formatMedicationEntry).filter(Boolean);
  drawListField("Medications", rxMedEntries, {
    emptyText: "None",
    bulletPrefix: "",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelSize: 12,
    valueSize: 12,
  });

  const nonRxRaw = get(fields, ["med_hist", "non_prescription_medications"], []);
  const nonRxEntries = normalizeTextEntries(nonRxRaw);
  drawListField("Non-prescription Medications", nonRxEntries, {
    emptyText: "None",
    bulletPrefix: "",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelSize: 12,
    valueSize: 12,
  });

  const allergySource = get(fields, ["med_hist", "allergies_list"], get(fields, ["med_hist", "allergies"], ""));
  drawListField("Allergies", normalizeTextEntries(allergySource), {
    emptyText: "None",
    bulletPrefix: "",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelSize: 12,
    valueSize: 12,
  });

  drawSectionHeading("Past Medical History (PMH):");
  const pmh = get(fields, ["med_hist", "past_med_his"], {});
  const pmhNbredStyle = {
    emptyText: "None",
    bulletPrefix: "",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelSize: 12,
    valueSize: 12,
  };
  drawListField("Childhood Illnesses", normalizeTextEntries(get(pmh, ["child_hood_illness"], "")), {
    ...pmhNbredStyle,
  });
  drawListField("Medical Illnesses and Hospitalizations", normalizeTextEntries(get(pmh, ["illness_and_hospital"], "")), {
    ...pmhNbredStyle,
  });
  drawListField("Surgeries", normalizeTextEntries(get(pmh, ["surgeries"], "")), {
    ...pmhNbredStyle,
  });
  drawListField("Obstetric/Gynecologic", normalizeTextEntries(get(pmh, ["obe_and_gye"], "")), {
    ...pmhNbredStyle,
    bulletPrefix: "-",
  });
  drawListField("Transfusion History", normalizeTextEntries(get(pmh, ["transfusion"], "")), {
    ...pmhNbredStyle,
  });
  drawListField("Psychiatric History", normalizeTextEntries(get(pmh, ["psychiatric"], "")), {
    ...pmhNbredStyle,
  });
  drawListField("Trauma", normalizeTextEntries(get(pmh, ["trauma"], "")), {
    ...pmhNbredStyle,
  });

  drawSectionHeading("Preventative Medicine:");
  const preventative = get(fields, ["med_hist", "preventative_measure"], {});
  const preventativeNbredStyle = {
    emptyText: "None",
    bulletPrefix: "",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelSize: 12,
    valueSize: 12,
  };
  drawListField("Immunizations", normalizeTextEntries(get(preventative, ["immunization"], "")), {
    ...preventativeNbredStyle,
  });
  drawListField("Screening Tests", normalizeTextEntries(get(preventative, ["screening_tests"], "")), {
    ...preventativeNbredStyle,
  });
  drawListField("Alternative/Complimentary Health Care", normalizeTextEntries(get(preventative, ["alternate_health_care"], "")), {
    ...preventativeNbredStyle,
  });
  drawListField("Travel/Exposure History", normalizeTextEntries(get(preventative, ["travel_exposure"], "")), {
    ...preventativeNbredStyle,
  });

  drawSectionHeading("Family Medical History:");
  const fam = get(fields, ["med_hist", "family_hist"], []);
  const familyGroups = (Array.isArray(fam) ? fam : [fam])
    .map((entry) => {
      if (!entry) return null;
      if (typeof entry === "string") {
        const text = entry.trim();
        return text ? { primary: text, additional: [] } : null;
      }
      const primary = formatFamilyHistoryEntry(entry);
      const additional = normalizeTextEntries(entry.additional_details || entry.notes || entry.additonal_info || "");
      return primary || additional.length ? { primary, additional } : null;
    })
    .filter(Boolean);
  drawGroupedListField(
    "Family Tree (e.g. health status, age, cause of death for appropriate family members)",
    familyGroups,
    {
      emptyText: "None reported",
      labelIndent: VALUE_INDENT,
      primaryIndent: VALUE_INDENT * 2,
      additionalIndent: VALUE_INDENT * 3,
      labelColor: COLORS.crimsonDark,
      labelWeight: "normal",
      labelSize: 12,
      valueSize: 12,
    }
  );
  newBodyPage();

  drawSectionHeading("Social History:");
  const socialNbredFieldStyle = {
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelSize: 12,
    valueSize: 12,
  };
  const socialNbredListStyle = {
    emptyText: "None",
    bulletPrefix: "-",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelSize: 12,
    valueSize: 12,
  };
  drawField("Personal Background", get(fields, ["med_hist", "social_hist", "personal_background"], ""), socialNbredFieldStyle);
  drawField("Nutritional and Excercise History", get(fields, ["med_hist", "social_hist", "nutrion_and_exercise"], ""), socialNbredFieldStyle);
  drawField("Military, Community, Educational & Employment History", get(fields, ["med_hist", "social_hist", "community_and_employment"], ""), socialNbredFieldStyle);
  drawField("Safety Measures", get(fields, ["med_hist", "social_hist", "safety_measure"], ""), socialNbredFieldStyle);
  drawField("Significant Life Stressors", get(fields, ["med_hist", "social_hist", "life_stressors"], ""), socialNbredFieldStyle);
  drawListField("Substance Abuse", normalizeTextEntries(get(fields, ["med_hist", "social_hist", "substance_use"], "")), socialNbredListStyle);
  const sexHist = get(fields, ["med_hist", "social_hist", "sex_history"], {});
  const explicitSexualHistoryEntries = normalizeTextEntries(get(fields, ["med_hist", "social_hist", "sexual_history_entries"], ""));
  const sexualHistoryEntries = explicitSexualHistoryEntries.length
    ? explicitSexualHistoryEntries
    : [
      pad(sexHist.current_partners) ? `Current partners: ${pad(sexHist.current_partners)}` : "",
      pad(sexHist.past_partners) ? `Past partners: ${pad(sexHist.past_partners)}` : "",
      pad(sexHist.contraceptives) ? `Contraceptives: ${pad(sexHist.contraceptives)}` : "",
      pad(sexHist.hiv_risk_history) ? `HIV risk: ${pad(sexHist.hiv_risk_history)}` : "",
      pad(sexHist.safety_in_relations) ? `Safety: ${pad(sexHist.safety_in_relations)}` : "",
    ].filter(Boolean);
  drawListField("Sexual History", sexualHistoryEntries, socialNbredListStyle);
  newBodyPage();

  drawSectionHeading("Review of Systems:");
  const ros = get(fields, ["med_hist", "sympton_review"], {});
  const reviewNbredFieldStyle = {
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelSize: 12,
    valueSize: 12,
  };
  const hematologicEndocrine = [pad(get(ros, ["hematologic"], "")), pad(get(ros, ["endocine"], ""))]
    .filter(Boolean)
    .join(", ");
  drawField("General", get(ros, ["general"], ""), reviewNbredFieldStyle);
  drawField("Skin", get(ros, ["skin"], ""), reviewNbredFieldStyle);
  drawField("HEENT", get(ros, ["heent"], ""), reviewNbredFieldStyle);
  drawField("Neck", get(ros, ["neck"], ""), reviewNbredFieldStyle);
  drawField("Breast", get(ros, ["breast"], ""), reviewNbredFieldStyle);
  drawField("Respiratory", get(ros, ["respiratory"], ""), reviewNbredFieldStyle);
  drawField("Cardivascular", get(ros, ["cardiovascular"], ""), reviewNbredFieldStyle);
  drawField("Gastrointestinal", get(ros, ["gastrointestinal"], ""), reviewNbredFieldStyle);
  drawField("Genitourinary", get(ros, ["genitourinary"], ""), reviewNbredFieldStyle);
  drawField("Peripheral Vascular", get(ros, ["peripheral_vascular"], ""), reviewNbredFieldStyle);
  drawField("Musculoskeletal", get(ros, ["musculoskeletal"], ""), reviewNbredFieldStyle);
  drawField("Psychiatric", get(ros, ["psychiatric"], ""), reviewNbredFieldStyle);
  drawField("Neurological", get(ros, ["neurologival"], ""), reviewNbredFieldStyle);
  drawField("Hematologic/Endocrine", hematologicEndocrine, reviewNbredFieldStyle);
  drawSectionHeading("Prompts and Special Instructions:");
  ensureSpace(20);
  y += 20;
  const promptsNbredListStyle = {
    emptyText: "\"None\"",
    bulletPrefix: "",
    labelIndent: VALUE_INDENT,
    valueIndent: VALUE_INDENT * 2,
    labelColor: COLORS.crimsonDark,
    labelWeight: "normal",
    labelSize: 12,
    valueSize: 12,
  };
  const quoteEntries = (value) =>
    normalizeTextEntries(value).map((entry) => `"${String(entry || "").replace(/^"+|"+$/g, "").trim()}"`);
  drawListField(
    "Provoking questions- ask the question below",
    quoteEntries(get(fields, ["special", "provoking_question"], "")),
    promptsNbredListStyle
  );
  drawListField(
    "Questions the patient MUST ask/ Statements patient must make",
    quoteEntries(get(fields, ["special", "must_ask"], "")),
    promptsNbredListStyle
  );
  drawListField(
    "Questions the patient will ask if given the opportunity",
    quoteEntries(get(fields, ["special", "oppurtunity"], "")),
    promptsNbredListStyle
  );

  // Part 5
  defaultFieldValueSize = 11;
  startPart("Part 5 - Notes for Internal Use Only", partPages);

  writeContentsPage(partPages);
  addPageNumbers();
  return doc;
}

export function downloadScriptPdf(item, versionObj) {
  const doc = buildScriptPdfDoc(item, versionObj);
  const safeName = buildScriptPdfFileName(item);
  doc.save(safeName);
}

export function getScriptPdfUrl(item, versionObj) {
  const doc = buildScriptPdfDoc(item, versionObj);
  return doc.output("bloburl");
}

export function printScriptPdf(item, versionObj) {
  const doc = buildScriptPdfDoc(item, versionObj);
  const safeName = buildScriptPdfFileName(item);

  try {
    doc.autoPrint();
    const url = doc.output("bloburl");
    const w = window.open(url, "_blank", "noopener,noreferrer");
    if (!w) {
      doc.save(safeName);
    }
  } catch {
    doc.save(safeName);
  }
}

function buildScriptPdfFileName(item) {
  const id = sanitizeFilePart(item?.id || "script");
  const title = sanitizeFilePart(item?.title || "");
  return title ? `${id}-${title}.pdf` : `${id}.pdf`;
}

function sanitizeFilePart(value) {
  return String(value || "")
    .trim()
    .replace(/[^\w.-]+/g, "_")
    .replace(/^_+|_+$/g, "");
}

export function downloadResourcePdf(item, resourceName) {
  const doc = new jsPDF({ unit: "pt", format: "letter" });
  const pageWidth = doc.internal.pageSize.getWidth();
  const margin = 36;
  let y = 62;

  doc.setFont("helvetica", "bold");
  doc.setFontSize(16);
  doc.setTextColor(COLORS.crimsonDark);
  doc.text("Resource Summary", pageWidth / 2, y, { align: "center" });
  y += 22;

  doc.setDrawColor(COLORS.border);
  doc.line(margin, y, pageWidth - margin, y);
  y += 16;

  doc.setFont("helvetica", "normal");
  doc.setFontSize(11);
  doc.setTextColor(COLORS.body);

  const rows = [
    ["Script", `${item.id} - ${item.title}`],
    ["Resource", resourceName],
    ["Note", "This is a placeholder export (no backend)."],
  ];

  rows.forEach(([label, value]) => {
    doc.setFont("helvetica", "bold");
    doc.setTextColor(COLORS.label);
    doc.text(`${label}:`, margin, y);
    doc.setFont("helvetica", "normal");
    doc.setTextColor(COLORS.body);
    const lines = doc.splitTextToSize(String(value || ""), pageWidth - margin * 2 - VALUE_INDENT);
    doc.text(lines, margin + VALUE_INDENT, y + 13);
    y += lines.length * 13 + 20;
  });

  const safeName = `${(item.id || "script").replace(/\s+/g, "_")}-${(resourceName || "resource").replace(/\s+/g, "_")}.pdf`;
  doc.save(safeName);
}

function buildDoorNotePdfFileName(fields = {}) {
  const name = sanitizeFilePart(get(fields, ["patient", "name"], ""));
  const reason = sanitizeFilePart(get(fields, ["admin", "reson_for_visit"], get(fields, ["patient", "visit_reason"], "")));
  if (name && reason) return `door-note-${name}-${reason}.pdf`;
  if (name) return `door-note-${name}.pdf`;
  if (reason) return `door-note-${reason}.pdf`;
  return "door-note.pdf";
}

export function createDoorNotePdfFile(script = {}, fileName = "") {
  const fields = script?.fields && typeof script.fields === "object" ? script.fields : (script || {});
  const doc = new jsPDF({ unit: "pt", format: "letter" });
  const pageWidth = doc.internal.pageSize.getWidth();
  const pageHeight = doc.internal.pageSize.getHeight();
  const marginLeft = 36;
  const marginRight = 36;
  const top = 54;
  const bottom = pageHeight - 48;
  const labelSize = 12;
  const valueSize = 11;
  const lineHeight = 13;
  let y = top;

  const ensureSpace = (space = 20) => {
    if (y + space > bottom) {
      doc.addPage();
      y = top;
    }
  };

  const drawTitle = (text) => {
    ensureSpace(24);
    doc.setFont("helvetica", "bold");
    doc.setFontSize(14);
    doc.setTextColor(COLORS.crimsonDark);
    doc.text(text, pageWidth / 2, y, { align: "center" });
    y += 22;
  };

  const drawSection = (text) => {
    ensureSpace(18);
    doc.setFont("helvetica", "bold");
    doc.setFontSize(12);
    doc.setTextColor(COLORS.body);
    doc.text(text, marginLeft, y);
    y += 16;
  };

  const drawField = (label, value) => {
    const clean = value === undefined || value === null ? "" : String(value).trim();
    const valueText = clean || "None";
    const wrapWidth = Math.max(40, pageWidth - marginLeft - marginRight - VALUE_INDENT);
    doc.setFont("helvetica", "normal");
    doc.setFontSize(valueSize);
    doc.setTextColor(COLORS.body);
    const wrapped = doc.splitTextToSize(valueText, wrapWidth);
    const blockHeight = lineHeight + Math.max(lineHeight, wrapped.length * lineHeight) + 6;
    ensureSpace(blockHeight);

    doc.setFont("helvetica", "bold");
    doc.setFontSize(labelSize);
    doc.setTextColor(COLORS.crimsonDark);
    doc.text(`${label}:`, marginLeft, y);
    y += lineHeight;

    doc.setFont("helvetica", "normal");
    doc.setFontSize(valueSize);
    doc.setTextColor(COLORS.body);
    doc.text(wrapped, marginLeft + VALUE_INDENT, y);
    y += Math.max(lineHeight, wrapped.length * lineHeight) + 6;
  };

  const drawListField = (label, entries) => {
    const lines = (entries || []).map((entry) => String(entry || "").trim()).filter(Boolean);
    const finalLines = lines.length ? lines : ["None"];
    const wrapWidth = Math.max(40, pageWidth - marginLeft - marginRight - VALUE_INDENT);
    doc.setFont("helvetica", "normal");
    doc.setFontSize(valueSize);
    doc.setTextColor(COLORS.body);
    const wrapped = finalLines.flatMap((line) => doc.splitTextToSize(`- ${line}`, wrapWidth));
    const blockHeight = lineHeight + Math.max(lineHeight, wrapped.length * lineHeight) + 6;
    ensureSpace(blockHeight);

    doc.setFont("helvetica", "bold");
    doc.setFontSize(labelSize);
    doc.setTextColor(COLORS.crimsonDark);
    doc.text(`${label}:`, marginLeft, y);
    y += lineHeight;

    doc.setFont("helvetica", "normal");
    doc.setFontSize(valueSize);
    doc.setTextColor(COLORS.body);
    doc.text(wrapped, marginLeft + VALUE_INDENT, y);
    y += Math.max(lineHeight, wrapped.length * lineHeight) + 6;
  };

  const drawHeartMarker = (cx, cy, size = 12) => {
    const radius = size * 0.28;
    const lobeY = cy - size * 0.18;
    doc.setFillColor(176, 12, 38);
    doc.setDrawColor(255, 255, 255);
    doc.setLineWidth(0.8);
    doc.circle(cx - radius, lobeY, radius, "FD");
    doc.circle(cx + radius, lobeY, radius, "FD");
    doc.triangle(
      cx - radius * 2,
      lobeY,
      cx + radius * 2,
      lobeY,
      cx,
      cy + size * 0.75,
      "FD"
    );
  };

  const drawSymptomDiagram = () => {
    ensureSpace(24);
    doc.setFont("helvetica", "bold");
    doc.setFontSize(labelSize);
    doc.setTextColor(COLORS.crimsonDark);
    doc.text("Symptom Location Diagram:", marginLeft, y);
    y += lineHeight;

    if (!hpiDiagramDataUrl) {
      drawField("Symptom Location Diagram", "Unavailable");
      return;
    }

    const rawMarkers = get(fields, ["sp", "current_ill_history", "symptom_diagram"], []);
    const markers = (Array.isArray(rawMarkers) ? rawMarkers : [rawMarkers])
      .map((m) => ({ x: Number(m?.x), y: Number(m?.y) }))
      .filter((m) => Number.isFinite(m.x) && Number.isFinite(m.y));

    try {
      const props = doc.getImageProperties(hpiDiagramDataUrl);
      const ratio = props?.width && props?.height ? props.height / props.width : 1;
      const maxDiagramWidth = Math.min(300, pageWidth - marginLeft - marginRight);
      const width = Math.max(140, maxDiagramWidth);
      const height = Math.max(40, width * ratio);
      ensureSpace(height + 10);
      const imageX = marginLeft + (pageWidth - marginLeft - marginRight - width) / 2;
      doc.addImage(hpiDiagramDataUrl, "PNG", imageX, y, width, height);
      markers.forEach((marker) => {
        const x = imageX + Math.max(0, Math.min(1, marker.x)) * width;
        const heartY = y + Math.max(0, Math.min(1, marker.y)) * height;
        drawHeartMarker(x, heartY, 12);
      });
      y += height + 8;
      doc.setFont("helvetica", "normal");
      doc.setFontSize(10);
      doc.setTextColor(COLORS.dark);
      doc.text(`Symptom markers: ${markers.length}`, imageX, y);
      y += 12;
    } catch {
      drawField("Symptom Location Diagram", "Unable to render diagram.");
    }
  };

  const doorTempReadingRaw = get(fields, ["patient", "vitals", "temp", "reading"], "");
  const doorTempReading = Number(doorTempReadingRaw);
  const doorTempUnitRaw = String(get(fields, ["patient", "vitals", "temp", "unit"], "")).toLowerCase();
  const doorIsFahrenheit = doorTempUnitRaw === "1" || doorTempUnitRaw.startsWith("f");
  const doorTempPair = Number.isFinite(doorTempReading) && doorTempReading > 0
    ? (
      doorIsFahrenheit
        ? `${doorTempReading.toFixed(1)}° F / ${(((doorTempReading - 32) * 5) / 9).toFixed(1)}° C`
        : `${doorTempReading.toFixed(1)}° C / ${((doorTempReading * 9) / 5 + 32).toFixed(1)}° F`
    )
    : "";

  const vitalLines = [
    `${pad(get(fields, ["patient", "vitals", "heart_rate"], "")) || "None"} beats/min`,
    `${pad(get(fields, ["patient", "vitals", "respirations"], "")) || "None"} respirations/min`,
    `${pad(get(fields, ["patient", "vitals", "pressure", "top"], "")) || "None"}/${pad(get(fields, ["patient", "vitals", "pressure", "bottom"], "")) || "None"} mmHg`,
    `${pad(get(fields, ["patient", "vitals", "blood_oxygen"], "")) || "None"} %`,
    doorTempPair || "None",
  ];

  drawTitle("Door Chart/Note and Learner Instruction");
  drawSection("Instructions to Learners:");
  drawField("Patient Name", get(fields, ["patient", "name"], ""));
  drawField("Date of Birth", get(fields, ["patient", "date_of_birth"], get(fields, ["patient", "dob"], "")));
  drawListField("Vital Signs", vitalLines);
  drawField("Reason For Visit", get(fields, ["patient", "visit_reason"], get(fields, ["admin", "reson_for_visit"], "")));
  drawField("Context", get(fields, ["patient", "context"], ""));
  drawField("Task", get(fields, ["patient", "task"], ""));
  drawField("Patient Encounter Duration", get(fields, ["patient", "encounter_duration"], ""));
  drawSymptomDiagram();

  const resolvedName = sanitizeFilePart(fileName);
  const safeName = resolvedName.endsWith(".pdf")
    ? resolvedName
    : (resolvedName ? `${resolvedName}.pdf` : buildDoorNotePdfFileName(fields));
  const blob = doc.output("blob");
  return new File([blob], safeName, { type: "application/pdf" });
}

